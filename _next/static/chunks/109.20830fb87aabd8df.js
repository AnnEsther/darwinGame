"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{1139:(t,e,s)=>{s.d(e,{A:()=>i});class i{setProgress(t){let e=t>1?Phaser.Math.Clamp(t/100,0,1):Phaser.Math.Clamp(t,0,1),s=Math.floor(this.barWidth*e);this.fill.clear(),this.fill.fillStyle(0xffff00,1),this.fill.fillRoundedRect(this.barX,this.barY,s,this.barHeight,6),this.percentText.setText("".concat(Math.round(100*e),"%"))}close(){let t=[this.bg,this.track,this.fill,this.label,this.percentText];this.scene.tweens.add({targets:t,alpha:0,duration:250,onComplete:()=>this.destroy()})}destroy(){this.scene.scale.off("resize",this._onResize),[this.bg,this.track,this.fill,this.label,this.percentText].forEach(t=>null==t?void 0:t.destroy())}_layout(t,e){this.bg.setSize(t,e),this.barWidth=Math.floor(.6*t),this.barHeight=18,this.barX=Math.floor((t-this.barWidth)/2),this.barY=Math.floor(e/2),this.label.setPosition(t/2,this.barY-40),this.percentText.setPosition(t/2,this.barY+28);let s=this.percentText.text.endsWith("%")?parseInt(this.percentText.text,10)/100:0;this.track.clear(),this.track.lineStyle(2,0xffffff,1),this.track.strokeRoundedRect(this.barX,this.barY,this.barWidth,this.barHeight,6),this.track.fillStyle(2236962,1),this.track.fillRoundedRect(this.barX,this.barY,this.barWidth,this.barHeight,6),this.setProgress(s)}constructor(t,e={}){var s,i;this.scene=t,this.depth=null!=(s=e.depth)?s:1e4,this.labelText=null!=(i=e.label)?i:"Loading…";let a=t.scale.width,h=t.scale.height;this.bg=t.add.rectangle(0,0,a,h,0,1).setOrigin(0,0).setScrollFactor(0).setDepth(this.depth).setInteractive(),this.barWidth=Math.floor(.6*a),this.barHeight=18,this.barX=Math.floor((a-this.barWidth)/2),this.barY=Math.floor(h/2),this.track=t.add.graphics().setScrollFactor(0).setDepth(this.depth+1),this.fill=t.add.graphics().setScrollFactor(0).setDepth(this.depth+2),this.label=t.add.text(a/2,this.barY-40,this.labelText,{fontFamily:"nokia",fontSize:"18px",color:"#ffffff"}).setOrigin(.5,.5).setScrollFactor(0).setDepth(this.depth+2),this.percentText=t.add.text(a/2,this.barY+28,"0%",{fontFamily:"nokia",fontSize:"16px",color:"#aaaaaa"}).setOrigin(.5,.5).setScrollFactor(0).setDepth(this.depth+2),this.track.clear(),this.track.lineStyle(2,0xffffff,1),this.track.strokeRoundedRect(this.barX,this.barY,this.barWidth,this.barHeight,6),this.track.fillStyle(2236962,1),this.track.fillRoundedRect(this.barX,this.barY,this.barWidth,this.barHeight,6),this.setProgress(0)}}},6509:(t,e,s)=>{s.d(e,{A:()=>a});class i{update(){var t=!1,e=!1;return this._0.x+this.sceneWidth<=0?(this._0.x=this._1.x+this.sceneWidth,t=!0):this._1.x+this.sceneWidth<=0&&(this._1.x=this._0.x+this.sceneWidth,e=!0),[t,e]}setVelocityX(t){this._0.setVelocityX(t),this._1.setVelocityX(t)}getHeight(){return this._0.displayHeight}setZIndex(t){this._0.setDepth(t),this._1.setDepth(t)}constructor(t,e){this.physicsGroup=t,this.sceneWidth=e.sceneWidth;var s="",i="";null==e.texture1?(s=e.texture0,i=e.texture0):(s=e.texture0,i=e.texture1),this._0=this.physicsGroup.create(e.x,e.y,s),this._0.setOrigin(e.origin[0],e.origin[1]);let a=this._0.width,h=e.displaySize[0]/a;this._0.setScale(h),this._0.setVelocityX(e.velocity),this._0.setImmovable(e.immovable),this._0.body.allowGravity=e.allowGravity,this._1=this.physicsGroup.create(this.sceneWidth,e.y,i),this._1.setOrigin(e.origin[0],e.origin[1]),this._1.setScale(h),this._1.setVelocityX(e.velocity),this._1.setImmovable(e.immovable),this._1.body.allowGravity=e.allowGravity}}class a{update(){this.cloud.update(),this.cloudSmall.update(),this.backgroundItem.update(),this.onGroundReset(this.ground.update()),this.grass.update()}setVelocityX(t){this.speed=t,this.gameStart?(this.cloud.setVelocityX(.2*t),this.cloudSmall.setVelocityX(.3*t),this.backgroundItem.setVelocityX(.8*t),this.ground.setVelocityX(t),this.grass.setVelocityX(1.2*t)):(this.cloud.setVelocityX(.2*t),this.cloudSmall.setVelocityX(.3*t))}constructor(t,e){this.scene=t,this.gameStart=!1,this.onGroundReset=e,this.physicsGroup=t.physics.add.group({allowGravity:!1,immovable:!0});let s=this.scene.scale.width,a=this.scene.scale.height;this.background=this.physicsGroup.create(0,0,"background"),this.background.setOrigin(0,0),this.background.setImmovable(!0),this.background.body.allowGravity=!1,this.ground=new i(this.physicsGroup,{x:0,y:a+0,texture0:"ground_0",texture1:"ground_1",origin:[0,1],displaySize:[s,a],velocity:0,immovable:!0,allowGravity:!1,sceneWidth:s});var h={x:0,y:this.ground._0.y-this.ground.getHeight()- -25,texture0:"cloud_big",texture1:null,origin:[0,0],displaySize:[s,a],velocity:0,immovable:!0,allowGravity:!1,sceneWidth:s};this.cloud=new i(this.physicsGroup,h),this.cloud._0.setY(this.cloud._0.y-this.cloud._0.displayHeight),this.cloud._1.setY(this.cloud._1.y-this.cloud._1.displayHeight),this.cloud._1.flipX=!0;var r={x:0,y:this.ground._0.y-this.ground.getHeight()- -25,texture0:"cloud_small_0",texture1:null,origin:[0,0],displaySize:[s,a],velocity:0,immovable:!0,allowGravity:!1,sceneWidth:s};this.cloudSmall=new i(this.physicsGroup,r),this.cloudSmall._0.setY(this.cloudSmall._0.y-this.cloudSmall._0.height-Math.random()*(a-this.cloudSmall._0.y-this.cloudSmall._0.height-100)),this.cloudSmall._1.setY(this.cloudSmall._1.y- -this.cloudSmall._0.height-Math.random()*(a-this.cloudSmall._1.y-this.cloudSmall._1.height-100));var l={x:0,y:this.ground._0.y-this.ground.getHeight()- -25,texture0:"background_item",texture1:null,origin:[0,0],displaySize:[s,a],velocity:0,immovable:!0,allowGravity:!1,sceneWidth:s};this.backgroundItem=new i(this.physicsGroup,l),this.backgroundItem._0.setY(this.backgroundItem._0.y-this.backgroundItem._0.displayHeight),this.backgroundItem._1.setY(this.backgroundItem._1.y-this.backgroundItem._1.displayHeight),this.grass=new i(this.physicsGroup,{x:0,y:a,texture0:"grass_0",texture1:"grass_1",origin:[0,1],displaySize:[s,a],velocity:0,immovable:!0,allowGravity:!1,sceneWidth:s}),this.ground.setZIndex(5),this.grass.setZIndex(6)}}},7109:(t,e,s)=>{class i extends Phaser.GameObjects.Container{_updateMaskPosition(){this.maskGraphics&&(this.maskGraphics.x=this.x+this._listX*this.scaleX,this.maskGraphics.y=this.y+this._listY*this.scaleY)}_startAutoScroll(){this.autoScroll&&!(this._maxScroll<=0)&&!this.isAutoScrolling&&(this.isAutoScrolling=!0,this._hadUpdateHook||(this._hadUpdateHook=!0,this._onUpdate=this._onUpdate.bind(this),this.scene.events.on("update",this._onUpdate)))}_stopAutoScroll(){this.isAutoScrolling=!1,this._restartTimer&&"function"==typeof this._restartTimer.remove&&(this._restartTimer.remove(),this._restartTimer=null),this._pauseTimer&&"function"==typeof this._pauseTimer.remove&&(this._pauseTimer.remove(),this._pauseTimer=null),this.autoScrollTween&&(this.autoScrollTween.stop(),this.scene&&this.scene.tweens&&this.scene.tweens.remove(this.autoScrollTween),this.autoScrollTween=null)}_restartAutoScrollAfterDelay(){this._restartTimer&&"function"==typeof this._restartTimer.remove&&this._restartTimer.remove(),this._restartTimer=this.scene.time.delayedCall(3e3,()=>{this.autoScroll&&this._maxScroll>0&&this._startAutoScroll()})}setScores(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.isAutoScrolling,s=this.scrollDirection,i=this._getScrollRatio();this._stopAutoScroll(),this.scores=Array.isArray(t)?t.slice():[],this._buildEntries(),this._resizeHandle(),this._recalcSpeed(),this._applyRatio(i),this.scrollDirection=s,(e||this.autoScroll)&&this._maxScroll>0&&this._startAutoScroll()}_getScrollRatio(){return!this._maxScroll||this._maxScroll<=0?0:Phaser.Math.Clamp(-this.entries.y/this._maxScroll,0,1)}_recalcSpeed(){let t=Math.max(this._maxScroll,0);if(t<=0){this._pxPerSec=0;return}this._pxPerSec=t/(this.scrollSpeed/1e3)}_applyRatio(t){this.entries.y=-t*(this._maxScroll||0),this._syncHandle()}_setPause(t){this._pauseTimer&&"function"==typeof this._pauseTimer.remove&&(this._pauseTimer.remove(),this._pauseTimer=null),this._pauseUntil=this.scene.time.now+t,this._pauseTimer=this.scene.time.delayedCall(t,()=>{this._pauseTimer=null})}_onUpdate(t,e){if(!this.isAutoScrolling||this._maxScroll<=0||this.scene.time.now<this._pauseUntil)return;let s=this._pxPerSec*(e/1e3)*this.scrollDirection,i=this.entries.y-s,a=!1;i<-this._maxScroll?(i=-this._maxScroll,a=!0,console.log(i)):i>-200&&(a=!0,console.log(i=-200)),this.entries.y=i,this._syncHandle(),a&&(this._setPause(this.pauseDuration),this.scrollDirection*=-1)}_buildEntries(){if(!this.entries)return;let t=this.scene;this.scores.sort((t,e)=>e.score-t.score),this.entries.removeAll(!0);let e=t.textures.get("item_bg");e&&e.getSourceImage()&&(this.rowHeight=e.getSourceImage().height+this.rowGap),this.scores.forEach((e,s)=>{let i=t.add.container(0,s*this.rowHeight),a=t.add.image(0,0,"item_bg").setOrigin(0,0),h="".concat(s+1,". ").concat(e.name),r=(h.length>28?h.slice(0,28)+"…":h).toUpperCase(),l=t.add.text(30,40,r,{fontFamily:"nokia",fontSize:"26px",color:"#000000"}).setOrigin(0,.5),o="".concat(e.company),c=(o.length>28?o.slice(0,28)+"…":o).toUpperCase(),n=t.add.text(68,3*a.height/4,c,{fontFamily:"nokia",fontSize:"20px",color:"#000000"}).setOrigin(0,.5),d=t.add.text(a.width-12,a.height/2,this._formatScore(e.score),{fontFamily:"nokia",fontSize:"36px",color:"#ffffff",stroke:"#000000",strokeThickness:2}).setOrigin(1,.5);i.add([a,l,n,d]),this.entries.add(i)});let s=this.scores.length*(this.rowHeight+this.rowGap);this._maxScroll=Math.max(s-this._listHeight+200,0),this.entries.y<-this._maxScroll&&(this.entries.y=-this._maxScroll),this._recalcSpeed()}_formatScore(t){return t>=1e9?(t/1e9).toFixed(1).replace(/\.0$/,"")+"B":t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":String(t)}_resizeHandle(){let t=this.track.y-.5*this.track.height*.9,e=this.track.y+.5*this.track.height*.9;this.handle.y=Phaser.Math.Clamp(this.handle.y,t,e)}_syncHandle(){let t=this.track.y-.5*this.track.height*.9,e=this.track.y+.5*this.track.height*.9;if(this._maxScroll>0){let s=-this.entries.y/this._maxScroll;this.handle.y=t+(e-t)*s}else this.handle.y=t}_ensureWhite(t){let e="__white";if(!t.textures.exists(e)){let s=t.make.graphics({x:0,y:0,add:!1});s.fillStyle(0xffffff,1).fillRect(0,0,2,2),s.generateTexture(e,2,2),s.destroy()}return e}destroy(t){this._stopAutoScroll(),this._restartTimer&&"function"==typeof this._restartTimer.remove&&(this._restartTimer.remove(),this._restartTimer=null),this._hadUpdateHook&&(this.scene.events.off("update",this._onUpdate),this._hadUpdateHook=!1),this.entries&&this.entries.clearMask(),this.maskGraphics&&(this.maskGraphics.destroy(),this.maskGraphics=null),super.destroy(t)}constructor(t,e,s,i=[],a=360,h=320,r={}){super(t,e,s),t.add.existing(this);let{overlay:l=!1,scale:o=1,autoScroll:c=!0,scrollSpeed:n=1e4,pauseDuration:d=2e3}=r;this.autoScroll=c,this.scrollSpeed=n,this.pauseDuration=d,this.autoScrollTween=null,this.isAutoScrolling=!1,this.scrollDirection=1,this._pxPerSec=0,this._pauseUntil=0,this._hadUpdateHook=!1,this._pauseTimer=null,this.scores=Array.isArray(i)?i.slice():[],this.rowHeight=88,this.headerHeight=0,this.paddingX=270,this.rowGap=8;let u=this._ensureWhite(t),g=t.add.sprite(0,0,"bg").setOrigin(.5).setDepth(100);a=g.width,h=g.height,this.add(g);let p=-a/2+this.paddingX,m=-h/2+(this.headerHeight+10),_=a-2*this.paddingX-40,y=.7*h-this.headerHeight;this._listX=p,this._listY=m,this._listWidth=_,this._listHeight=y,this.entries=t.add.container(p,m),this.add(this.entries),this._buildEntries(),this._recalcSpeed();let b=t.add.sprite(g.x+.4*g.width,g.y+.08*g.height,"slide").setOrigin(.5);this.add(b),this.track=b;let S=t.add.sprite(b.x,b.y,"slider").setOrigin(.5);S.setInteractive({draggable:!0,useHandCursor:!0}),this.add(S),this.handle=S,this.maskGraphics=t.make.graphics({add:!1}),this.maskGraphics.fillStyle(0xffffff),this.maskGraphics.fillRect(0,0,_+150,y);let f=this.maskGraphics.createGeometryMask();this.maskGraphics.x=this.x+p,this.maskGraphics.y=this.y+m+200,this.entries.setMask(f),this._geometryMask=f;let x=t.add.sprite(p+_/2,m+y/2,u).setOrigin(.5);x.displayWidth=_,x.displayHeight=y,x.setAlpha(.001).setInteractive(),this.add(x),x.on("wheel",(t,e,s)=>{this._stopAutoScroll(),this.entries.y=Phaser.Math.Clamp(this.entries.y-2*s,-this._maxScroll,0),this._syncHandle(),this._restartAutoScrollAfterDelay()}),this._resizeHandle(),this.entries.y=0,this._syncHandle(),t.input.setDraggable(S),S.on("drag",(t,e,s)=>{this._stopAutoScroll();let i=this.track.y-.5*this.track.height*.9,a=this.track.y+.5*this.track.height*.9;if(S.y=Phaser.Math.Clamp(s,i,a),this._maxScroll>0){let t=(S.y-i)/(a-i);this.entries.y=-t*this._maxScroll}}),S.on("dragend",()=>{this._restartAutoScrollAfterDelay()}),1!==o&&(this.setScale(o),this._updateMaskPosition()),this.autoScroll&&this._maxScroll>0&&this._startAutoScroll()}}var a=s(6509);class h extends Phaser.Scene{init(t){this.playerName=t.playerName,this.coins=t.coins,this.highScores=[]}async create(){this.background=new a.A(this,()=>{}),this.background.setVelocityX(-700),this.leaderboard=new i(this,this.cameras.main.centerX,this.cameras.main.centerY,this.highScores,this.scale.width/2,this.scale.height/2,{overlay:!0}),this.leaderboard.setDepth(10),this.input.keyboard.on("keydown-L",()=>{this.leaderboard&&this.leaderboard.scene||(this.leaderboard=new i(this,this.cameras.main.centerX,this.cameras.main.centerY,t,360,320,{overlay:!0}))});let t=await this.fetchLeaderboard();this.updateScore(t),this.polling=this.startLeaderboardPolling(this.updateScore.bind(this))}updateScore(t){this.leaderboard.setScores(t),console.log(t)}startLeaderboardPolling(t){return setInterval(async()=>{try{let e=await this.fetchLeaderboard();t(e)}catch(t){console.error("Failed to fetch leaderboard:",t)}},1e4)}async fetchLeaderboard(){let t=await fetch("https://darwinbox.com/api/videoGame/leaderboard",{method:"GET",headers:{Accept:"application/json"}});if(!t.ok)throw Error("Leaderboard failed: ".concat(t.status));return((await t.json()).leaderboard||[]).map(t=>({name:t.userName,score:Number(t.userScore)||0}))}constructor(){super("LeaderboardScene")}}var r=s(1139);class l extends Phaser.Scene{preload(){this.overlay=new r.A(this,{label:"Loading…"}),this.load.on("progress",t=>this.overlay.setProgress(t)),this.load.once("complete",()=>{this.overlay.setProgress(1),this.overlay.close(),this.scene.start("LeaderboardScene",{getInfo:!0,name:"",company:"",email:""})}),this.load.image("background","assetsL/Enviornment/background.png"),this.load.image("background_item","assetsL/Enviornment/background_item.png"),this.load.image("cloud_big","assetsL/Enviornment/cloud_big.png"),this.load.image("cloud_small_0","assetsL/Enviornment/cloud_small_0.png"),this.load.image("ground_0","assetsL/Enviornment/ground_0.png"),this.load.image("ground_1","assetsL/Enviornment/ground_1.png"),this.load.image("grass_0","assetsL/Enviornment/grass_0.png"),this.load.image("grass_1","assetsL/Enviornment/grass_1.png"),this.load.image("bg","assetsL/leaderboard_bg.png"),this.load.image("item_bg","assetsL/leaderboard_item.png"),this.load.image("slider","assetsL/leaderboard_slider.png"),this.load.image("slide","assetsL/leaderboard_slide.png")}create(){this.time.delayedCall(2e3,()=>{this.scene.start("LeaderboardScene",{getInfo:!0,name:"",company:"",email:""})})}constructor(){super("landingSceneL")}}let o={type:Phaser.AUTO,width:1920,height:1080,parent:"game-holder",dom:{createContainer:!0},physics:{default:"arcade",arcade:{gravity:{y:700},debug:!1}},scene:[l,h]};new Phaser.Game(o)}}]);